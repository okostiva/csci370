(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/all.js#xfbml=1";fjs.parentNode.insertBefore(js,fjs);}(document,"script","facebook-jssdk"));var forbes=(function(app,$){app.article_vestpocket=(function($){var debug=null,_expand_timer=null,_reveal_timer=null,_expand_delay=300,_reveal_delay=500,_vp=null,_vp_position=null,_body_children_selectors="p:not(.pagination), embed, iframe, object, div:not(.feature_image, #sticky_sharing, .position_anchor, .zemanta-pixie), aside:not(.vestpocket), blockquote";function _init(){debug=forbes.util.debug;if(!$(".article .body").hasClass("contains_vestpocket")||$(".article .body .vestpocket").length<1){return false;}_vp=$(".article .body .vestpocket");_position_in_content();_init_expandable_vestpockets();_admin_init();forbes.article_pages.process_embeddables();}function _position_in_content(){var child_elements=$(".article .body").children(_body_children_selectors);if(child_elements.length<1){return false;}_vp_position=parseInt(_vp.attr("data-position"),10);if(_vp_position<2){_vp_position=2;}if(child_elements.length==1){_vp_position=1;}else{if(_vp_position>child_elements.length){_vp_position=child_elements.length;}}var position_element=child_elements.eq(_vp_position-1);if(position_element.length<1){return false;}if(position_element.prev().hasClass("position_anchor")){_vp.detach().insertBefore(position_element.prev());}else{_vp.detach().insertBefore(position_element);}_vp.show();}function _init_expandable_vestpockets(){$(".article .body .vestpocket .box.expandable").unbind("mouseenter").bind("mouseenter",function(event){var expandable=$(this);if(expandable.hasClass("hovering")){return false;}expandable.addClass("hovering");clearTimeout(_expand_timer);_expand_timer=setTimeout(function(){if(expandable.hasClass("hovering")){expandable.addClass("loading");}clearTimeout(_reveal_timer);_reveal_timer=setTimeout(function(){if(expandable.hasClass("hovering")){expandable.removeClass("loading").addClass("active");if(expandable.find(".layer_bottom[origwidth]").length<1){expandable.find(".layer_bottom").attr("origwidth",expandable.find(".layer_bottom").width());expandable.find(".layer_bottom").attr("origheight",(expandable.find(".layer_top").height()+parseInt(expandable.css("padding-top"))+parseInt(expandable.css("padding-bottom"))));}var orig_width=expandable.find(".layer_bottom").attr("origwidth");var orig_height=expandable.find(".layer_bottom").attr("origheight");if(expandable.find("ul.list_placements li.collapsed").length>0){expandable.find("ul.list_placements li").each(function(index){if($(this).hasClass("collapsed")){var this_placement=$(this);var new_top=parseInt(expandable.find("ul.list_placements li:eq("+(index-1)+")").innerHeight());if(index>1){new_top+=parseInt(expandable.find("ul.list_placements li:eq("+(index-1)+")").css("top"));}this_placement.css({top:new_top,opacity:0});setTimeout(function(){this_placement.stop().animate({opacity:1},200,"swing");},200);}});}var max_z=-1000000;$(".article .body .vestpocket .box.expandable").each(function(){var this_z=parseInt($(this).css("z-index"));if(this_z>max_z){max_z=this_z;}});expandable.css({"z-index":(max_z+1)});expandable.find(".layer_bottom").stop();expandable.find(".layer_bottom").css("opacity",0).show().width(orig_width).height(orig_height).animate({opacity:1},150,function(){var viewport_height=expandable.find(".layer_bottom .viewport").height();expandable.find(".layer_bottom").animate({width:420,height:((orig_height>viewport_height)?orig_height:viewport_height)},150);});}},_reveal_delay);},_expand_delay);});$(".article .body .vestpocket .box.expandable").unbind("mouseleave").bind("mouseleave",function(){$(this).find(".layer_bottom").hide();$(this).removeClass("hovering loading active");});}function _admin_init(){if(!$("body").hasClass("admin_mode")||!_vp){if(_vp){_vp.find(".admin_controls").hide();}return false;}_vp.unbind("mouseenter").bind("mouseenter",function(){$(this).addClass("hovering");});_vp.unbind("mouseleave").bind("mouseleave",function(){$(this).removeClass("hovering");});_vp.find(".admin_controls a.up").unbind("click").bind("click",function(){if(!$(this).hasClass("disabled")){_admin_change_position(_vp_position-1);}return false;});_vp.find(".admin_controls a.down").unbind("click").bind("click",function(){if(!$(this).hasClass("disabled")){_admin_change_position(_vp_position+1);}return false;});_admin_change_position(_vp_position);}function _admin_change_position(new_pos){if(new_pos<1){return false;}if(new_pos<=1){_vp.find(".admin_controls a.up").addClass("disabled");}else{_vp.find(".admin_controls a.up").removeClass("disabled");}if(new_pos>=($(".article .body").children(_body_children_selectors).length-3)){_vp.find(".admin_controls a.down").addClass("disabled");}else{_vp.find(".admin_controls a.down").removeClass("disabled");}_vp.attr("data-position",new_pos);_position_in_content();forbes.article_pages.process_embeddables();}return{init:_init,admin_init:_admin_init};}($));return app;}(forbes||{},jQuery));var forbes=(function(app,$){app.article_pages=(function($){var debug=null,_vestpocket=false,_sticky_sharing=false;function _init(){debug=forbes.util.debug;_init_scroll_to_links();if($(".article .body .vestpocket").length>0){_vestpocket=$(".article .body .vestpocket");}if($("#sticky_sharing").length>0){_sticky_sharing=$("#sticky_sharing");}forbes.article_vestpocket.init();if($(".article .body .forbes_embedded_gallery").length>0){if(typeof forbes.galleries!="undefined"&&typeof forbes.galleries.engine!="undefined"){setTimeout(function(){debug("about to init galleries");forbes.galleries.engine.init();},5000);}}_process_embeddables();_init_report_corrections();}function _process_embeddables(){$(".article .body").find("iframe, div.gallery_embedded, object, embed, p img, blockquote").each(function(i){var disable_height_change=false,disable_width_change=false,only_set_max_width=false,total_width=$(".article .body").width(),max_width=total_width,override_blockquote_margins=false,orig_height=-1,orig_width=-1,$this=$(this),is_img=$this.is("img"),is_blockquote=$this.is("blockquote");if(is_img){max_width-=40;}if(!$this.hasClass("dimensions_initialized")){if(typeof $this.attr("height")!="undefined"&&$this.attr("height")!==""&&$this.attr("height")!==false){orig_height=$this.attr("height")+" ";if(orig_height.indexOf("%")!=-1){orig_height=350;}orig_height=parseInt(orig_height,10);}else{if(is_img){disable_height_change=true;}else{orig_height=350;}}if(typeof $this.attr("width")!="undefined"&&$this.attr("width")!==""&&$this.attr("width")!==false&&!disable_height_change){orig_width=$this.attr("width")+" ";if(orig_width.indexOf("%")!=-1){orig_width=max_width;}orig_width=parseInt(orig_width,10);}else{if(is_img&&disable_height_change){only_set_max_width=true;}else{orig_width=max_width;}}$('<span class="position_anchor"></span>').insertBefore($this);if(!is_blockquote){$this.attr("data-orig-height",orig_height);$this.attr("data-orig-width",orig_width);}$this.addClass("dimensions_initialized");}else{if(!is_blockquote){orig_height=parseInt($this.attr("data-orig-height"),10);orig_width=parseInt($this.attr("data-orig-width"),10);if(orig_width<0){only_set_max_width=true;}}}if(_vestpocket!==false){var position_anchor=$this.prev(".position_anchor");var element_top=position_anchor.position().top;var vestpocket_top=_vestpocket.position().top;var vestpocket_height=_vestpocket.height();if(($.browser.msie&&parseInt($.browser.version,10)<8)||(element_top>=vestpocket_top&&element_top<(vestpocket_top+vestpocket_height))){max_width-=(_vestpocket.width()+parseInt(_vestpocket.css("margin-right"),10));if(is_blockquote){override_blockquote_margins=true;}}}if(_sticky_sharing.hasClass("in_article_body")){var position_anchor=$this.prev(".position_anchor");var element_top=position_anchor.position().top;var sharing_top=_sticky_sharing.position().top;var sharing_height=_sticky_sharing.find("div.controls").height();if(($.browser.msie&&parseInt($.browser.version)<8)||(element_top>=sharing_top&&element_top<(sharing_top+sharing_height))){max_width-=(_sticky_sharing.width()+parseInt(_sticky_sharing.css("margin-left"),10));}if(typeof $this.attr("src")!="undefined"&&$this.attr("src").indexOf("storify.com")!=-1){$(".sfy-story").find("iframe").css({width:"530px"});}}else{if(typeof $this.attr("src")!="undefined"&&$this.attr("src").indexOf("storify.com")!=-1){$(".sfy-story").find("iframe").css({width:"620px"});}}if(typeof $this.attr("src")!="undefined"&&$this.attr("src").indexOf("trefis")!=-1){disable_height_change=true;}if(typeof $this.attr("src")!="undefined"&&$this.attr("src").indexOf("video.forbes.com")!=-1){disable_height_change=true;disable_width_change=true;}if(typeof $this.attr("src")!="undefined"&&$this.attr("src").indexOf("ycharts.com")!=-1){disable_height_change=true;disable_width_change=true;}if(typeof $this.attr("data")!="undefined"&&$this.attr("data").indexOf("charts.wikinvest.com")!=-1){if(typeof $this.attr("width")!="undefined"&&parseInt($this.attr("width"),10)<500){disable_height_change=true;disable_width_change=true;}}if(typeof $this.attr("src")!="undefined"&&$this.attr("src").indexOf("embed.newsinc.com")!=-1){disable_height_change=true;disable_width_change=true;}var ratio=max_width/orig_width;if(is_img&&ratio>1){ratio=1;}if(is_blockquote){if(override_blockquote_margins){$this.find("p").css({left:0,"margin-right":"50px"});}else{$this.find("p").attr("style","");}}else{if(only_set_max_width){$this.css("max-width",Math.floor(orig_width*ratio));}else{if(!disable_width_change){$this.attr("width",Math.floor(orig_width*ratio));}if(!disable_height_change){$this.attr("height",Math.floor(orig_height*ratio));}}}$this.css("position","relative");});}function _init_scroll_to_links(){if($("a.scroll_to").length<1){return false;}$("a.scroll_to[href*=#][data-initialized!=true]").click(function(e){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var $target=$(this.hash);$target=$target.length&&$target||$("[name="+this.hash.slice(1)+"]");if($target.length){e.preventDefault();forbes.util.scroll_to_obj($target,{duration:500});}}});$("a.scroll_to[data-initialized!=true]").attr("data-initialized","true");}function _init_report_corrections(){$(".article_actions .corrections a").unbind("click").bind("click",function(){var $this=$(this),br="%0A",mailto="mailto:corrections@forbes.com",title=encodeURIComponent($(".article_head h1").text()),author_name=encodeURIComponent($(".article_head .entity_block p.user a").text()),url=encodeURIComponent($('meta[property="og:url"]').attr("content"));mailto+="?subject="+encodeURIComponent("Report Correction");mailto+="&body=Reporting correction for:"+br+br;mailto+="Title: "+title;mailto+=br+"URL: "+url;mailto+=br+br+"--"+br+br;mailto+="Your Name:"+br;mailto+="Correction Request:";mailto+=br+br+br+"--"+br+br+"Thank you for reporting a correction. Forbes staff will review your concern.";window.location=mailto;return false;});}return{init:_init,process_embeddables:_process_embeddables};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.article_pages.init);var forbes=(function(app,$){app.comments=(function($){function _init(){if($("#comments").length>0){$comment_stream=$("#comments");$comments_well=$comment_stream.find(".comments_well");_init_no_called_out();_init_main_comment_nav();_init_badges();_init_threading();_init_collapsable_comments();_init_comment_bugs();_init_abuse_flags();_init_reply_links();_init_page_ui();_check_for_selected_comment_id();_admin_init();}}function _init_page_ui(){forbes.pagination_controls.init($comment_stream);_init_pagination_links();}function _check_for_selected_comment_id(){var selected_id=$("#comments").attr("data-selected-comment-id");if(typeof selected_id!="undefined"){if(selected_id.length>0&&selected_id!=""){var target=$("li.comment[data-comment-wp-id="+selected_id+"]");if(target.length<1){return false;}_check_comment_mode();setTimeout(function(){forbes.util.scroll_to_obj(target,{duration:800,valign:true,highlight:true});},600);$("li.collapsable.grouped[data-comment-wp-id="+selected_id+"]").css("background","whiteSmoke").css("background-color","whiteSmoke");}}}function _update(){_init_threading();_init_badges();_init_collapsable_comments();_init_abuse_flags();_check_comment_mode();_init_comment_bugs();_init_reply_links();_admin_init();}function _init_abuse_flags(){$("#comments .comment_controls a.flag_link").unbind("click").bind("click",function(){var $this=$(this),br="%0A",mailto="mailto:blogadmin@forbes.com";mailto+="?subject="+encodeURIComponent("Flag comment abuse");mailto+="&body=Flagged Comment:"+br+encodeURIComponent($this.parent().find("a.permalink").attr("href"));var username=$this.parents("li").find(".entity_block a.user_name");if(username.length>0){mailto+=br+br+"Comment authored by: "+username.text();}mailto+=br+br+"--"+br+br+"Please describe your concern with this comment:";mailto+=br+br+br+"--"+br+br+"Your Name:";mailto+=br+br+br+"--"+br+br+"Thank you for reporting this issue. Forbes staff will review your concern.";window.location=mailto;return false;});}function _init_reply_links(){var $comment_reply=$("#comment_reply");$("#comments li.comment .comment_controls a.reply").unbind("click").bind("click",function(){var $parent_comment=$(this).parents("li.comment"),parent_id=$parent_comment.attr("data-comment-wp-id"),$insert_anchor,$resize_parent_group;$comment_reply.find('form#idCommentForm input[name="comment_parent"]').val(parent_id);if($parent_comment.length>0){$comment_reply.addClass("inline").find("div.reply_header").show();if($parent_comment.parents("li.collapsable_group.level1").length>0){$insert_anchor=$parent_comment.parents("li.collapsable_group.level1");}else{$insert_anchor=$parent_comment;}if($comment_reply.parents("li.collapsable_group").length>0){if($comment_reply.parents("li.collapsable_group").index()!=$parent_comment.parents("li.collapsable_group").index()){$resize_parent_group=$comment_reply.parents("li.collapsable_group");}}$comment_reply.detach().insertAfter($insert_anchor);if(typeof $resize_parent_group!="undefined"){_expand_group($resize_parent_group);}if($insert_anchor.parents("li.collapsable_group").length>0){var group=$parent_comment.parents("li.collapsable_group");group.height(parseInt(group.attr("data-expanded-height"))+$comment_reply.outerHeight()+15);}}forbes.util.scroll_to_obj($("#comment_reply"),{duration:250,valign:true});return false;});$comment_reply.find("a.cancel_reply").unbind("click").bind("click",function(){var parent_comment=$("#comment_reply").prev();_reset_comment_reply();if(parent_comment.parents("li.collapsable_group").length>0){_expand_group(parent_comment.parents("li.collapsable_group"));}if(parent_comment.length>0){forbes.util.scroll_to_obj(parent_comment,{duration:250,valign:true});}return false;});}function _reset_comment_reply(){var $comment_reply=$("#comment_reply");if($comment_reply.hasClass("inline")){$comment_reply.find(".reply_header").hide();$comment_reply.find('form#idCommentForm input[name="comment_parent"]').val("0");$comment_reply.removeClass("inline").detach().appendTo("#comments .comment_form_orig_position");}}function _init_badges(){$('#comments .comment[data-badges-init!="true"]').each(function(index){$this=$(this);var advoice_badge=$this.attr("data-badges-advoice");if($this.hasClass("advoice")){if($this.hasClass("author")){$this.prepend('<div class="badge">'+advoice_badge+"Voice Author</div>");}else{$this.prepend('<div class="badge">'+advoice_badge+"Voice</div>");}}if($this.hasClass("author")){if($this.hasClass("advoice")){}else{$this.prepend('<div class="badge">'+advoice_badge+"Author</div>");}}$(this).attr("data-badges-init","true");});}function _init_threading(){$('#comments .comment[data-threading-init!="true"]').each(function(index){if($(this).hasClass("level0")&&$(this).next().hasClass("level1")){$(this).next().addClass("first_reply");}$(this).attr("data-threading-init","true");});}function _admin_init(){var edit_post_link=$(".comments_well").attr("data-edit-post-link");if(typeof edit_post_link!=="undefined"&&edit_post_link!=""){$(".comments_well .comments_stream li.comment").each(function(){_init_call_out_button(this);});}}function _init_call_out_button(comment_obj){var called_out_state=$(comment_obj).find(".comment_controls").attr("data-called-out-state");if(called_out_state=="on"){$(comment_obj).find(".comment_controls .right_col").prepend('<a href="#" class="call_out_control" data-action="undo_call_out">Undo Call Out</a>');}else{if(called_out_state=="off"){$(comment_obj).find(".comment_controls .right_col").prepend('<a href="#" class="call_out_control" data-action="call_out">Call Out</a>');}}$(comment_obj).find(".comment_controls .right_col .call_out_control").unbind("click").click(function(){var call_out_control_obj=this;var id=$(comment_obj).attr("data-comment-id");id=id.replace("comment_blogAndPostId/blog/comment/","");var id_parts=id.split("-");var action=$(call_out_control_obj).attr("data-action");forbes.util.debug("Action: "+action);var ppi_action=null;if(action=="call_out"){ppi_action="on";}else{if(action=="undo_call_out"){ppi_action="off";}}if(!!ppi_action){$.post("/wp-admin/admin-ajax.php",{action:"ppi_cicero_comment_callout",callout:ppi_action,blogid:id_parts[0],postid:id_parts[1],commentid:id_parts[2]},function(data){if(!!data){if(action=="call_out"){$(call_out_control_obj).attr("data-action","undo_call_out");$(call_out_control_obj).html("Undo Call Out");$(comment_obj).removeClass("collapsable").addClass("calledOut");}else{if(action=="undo_call_out"){$(call_out_control_obj).attr("data-action","call_out");$(call_out_control_obj).html("Call Out");$(comment_obj).removeClass("calledOut").addClass("collapsable");}}$(".comments_stream .collapsable_group").not(".collapsed").find(".comment").addClass("expanded");$("#comments li.comment").removeClass("grouped").removeClass("initialized");var commentElements=$("#comments li.comment").detach();$(".comments_stream").empty().append(commentElements);commentElements=null;$(".comments_stream .comment_events").remove();_init_collapsable_comments();$("#comments li.comment.grouped.expanded").parents(".collapsable_group").each(function(){_expand_group($(this));});}else{forbes.util.debug("ERROR: Received negative AJAX response.");}return false;});}return false;});}function _init_load_more_buttons(){$("#comments li.load_more a").unbind("click").bind("click",function(e){if($("#comments").hasClass("loading_mode")){return false;}e.preventDefault();var attach_back=$(this).parent();attach_back.addClass("loading");$.get($(this).parent().attr("data-url"),{comment_thread_id:$(this).parent().attr("data-comment-thread-id")},function(data){if($("#comments div#loaded_comments_holder").length<1){$("#comments").append('<div id="loaded_comments_holder" style="display:none;"></div>');}$("div#loaded_comments_holder").html(data);$("div#loaded_comments_holder").find("li.comment").addClass("animate_height");attach_back.after($("div#loaded_comments_holder").html());$("div#loaded_comments_holder").html("");attach_back.remove();_update();$("#comments li.comment.animate_height").each(function(index){var total_height=$(this).height();$(this).css({height:0,overflow:"hidden"});$(this).stop().animate({height:total_height},{duration:500,easing:"easeInOutCubic",complete:function(){$(this).removeClass("animate_height");}});});});});}function _init_collapsable_comments(){forbes.util.debug("_init_collapsable_comments");var html="";html+='<li class="collapsable_group round_bottom_corners">';html+='<div class="header controls">';html+='<div class="expand_control">';html+="<span>[expandmessage]</span>";html+="</div>";html+='<div class="collapse_control" style="display:none;">';html+="<span>[collapsemessage]</span>";html+="</div>";html+="</div>";html+="<ul></ul>";html+="</li>";for(var i=0,len=$("#comments li.comment").length;i<len;i++){var $this=$("#comments li.comment").eq(i);if($this.hasClass("grouped")){continue;}if($this.hasClass("collapsable")){var found_match=true,grouping=new Array();grouping.push($this);$this.addClass("grouped");var first_level=($this.hasClass("level0"))?"level0":"level1";while(found_match){i++;var $next=$("#comments li.comment").eq(i);if($next.hasClass("collapsable")&&$next.hasClass(first_level)){grouping.push($next);$next.addClass("grouped");}else{if($next.hasClass("collapsable")){i=(i-1);}found_match=false;}}var expand_message="+ expand comment";var collapse_message="- collapse comment";if(grouping.length>1){expand_message="+ expand "+grouping.length+" comments";collapse_message+="s";}var new_html=html.replace("[expandmessage]",expand_message);new_html=new_html.replace("[collapsemessage]",collapse_message);var collapsable_group=$(new_html).insertBefore($this);if($this.hasClass("level1")){collapsable_group.addClass("level1");}if($this.hasClass("first_reply")){$this.removeClass("first_reply");collapsable_group.addClass("first_reply");collapsable_group.prepend('<div class="reply_arrow"></div>');}collapsable_group.attr("data-num-collapsed",grouping.length);for(var cur=0;cur<grouping.length;cur++){grouping[cur].detach().appendTo(collapsable_group.find("ul"));}collapsable_group.find(".comment:first").css({"margin-top":0});collapsable_group.attr("data-expanded-height",collapsable_group.height());if(collapsable_group.prev().length==0||(!collapsable_group.hasClass("level1")&&collapsable_group.prev().hasClass("level1"))){collapsable_group.addClass("needs_top_margin");}if(!collapsable_group.hasClass("level1")){collapsable_group.find(".header");}}}$("#comments li.collapsable_group").each(function(){var _self=$(this);_self.css({overflow:"hidden",height:_self.find(".header").position().top+_self.find(".header").outerHeight()});_self.addClass("collapsed");_self.addClass("initialized");_self.find(".header.controls span").unbind("click").bind("click",function(){var group=$(this).parent().parent().parent();if(!group.hasClass("collapsed")){_collapse_group(group);}else{_expand_group(group);}return false;});});var comment_events_html='<ul class="comment_events"><li class="call_outs"><div class="icon"></div>Called-out comment</li></ul>';$("#comments li.comment.calledOut .comment_content").after(comment_events_html);}function _init_no_called_out(){$("#comments li.no_calledout .no_calledout_header span").off("click").on("click",function(event){var expand_li=$(this).parent().parent().parent();var expand_url=expand_li.attr("data-expand-url");if($("#comments").hasClass("loading_mode")){return false;}$("#comments ul.horznav li").removeClass("active");$("#comments ul.horznav li").last().addClass("active");_load_comments_stream(expand_url);return false;});}function _init_main_comment_nav(){$("#comments ul.horznav li").off("click").on("click",function(event){var $this=$(this);var nav_group_url=$this.find("a").attr("href");if($("#comments").hasClass("loading_mode")){return false;}$("#comments ul.horznav li").removeClass("active");$(this).addClass("active");_load_comments_stream(nav_group_url);return false;});}function _expand_group(group){var header=group.find(".header");group.removeClass("collapsed");group.find(".expand_control").hide();group.find(".collapse_control").show();group.stop().animate({height:parseInt(group.attr("data-expanded-height"))+"px"},{duration:parseInt(group.attr("data-num-collapsed"))*65,easing:"easeInCubic"});}function _collapse_group(group){var header=group.find(".header");group.addClass("collapsed");group.find(".expand_control").show();group.find(".collapse_control").hide();group.stop().animate({height:header.position().top+header.outerHeight()},{duration:parseInt(group.attr("data-num-collapsed"))*65,easing:"easeOutCubic"});}function _check_comment_mode(){var stream_flag=$("#comments ul.horznav li.active a").attr("rel");if(stream_flag=="calledOut"){$("#comments li.collapsable_group").each(function(){_collapse_group($(this));});}else{if(stream_flag=="allComments"){$("#comments li.collapsable_group").each(function(){_expand_group($(this));});}}}function _init_pagination_links(){$comment_stream.find("nav.pagination ul li a").off("click").on("click",function(event){var $this=$(this);var is_disabled=$this.parent().hasClass("disabled");forbes.util.debug(is_disabled);if(is_disabled!=true){_load_comments_stream($this.attr("href"));}return false;});}function _load_comments_stream(ajax_url){forbes.util.scroll_to_obj($comment_stream,{duration:300});$.ajax({type:"get",url:ajax_url,data:{ajax:"true"},dataType:"html",timeout:10*1000,cache:false,error:function(e,textStatus,errorThrown){forbes.util.debug("error loading: "+ajax_url);forbes.util.debug("error textStatus: "+textStatus);forbes.util.debug("error errorThrown: "+errorThrown);},success:function(data){$comments_well.html(data);_update();_init_page_ui();_init_no_called_out();_check_comment_mode();}});}function _init_comment_bugs(){if($(".comment_bug").length<1){return false;}_draw_comment_bugs();if($(".comment_bug .called_out_sampling a.head").length<1){$(".comment_bug > div").hide();$(".comment_bug .no_comment_bugs_exist_yet").show();$(".comment_bug").css({height:"auto"});return false;}$(".comment_bug").each(function(i){if(i==0){$(this).addClass("article_header");}else{$(this).addClass("article_footer");}});$(".comment_bug a.head").unbind("mouseenter").bind("mouseenter",function(){_expand_comment_bug($(this));});$(".comment_bug .called_out_sampling").unbind("mouseleave").bind("mouseleave",function(){$(this).parent().parent().removeClass("show_teaser");$(this).find("a.head").each(function(){$(this).css({opacity:1});});});}function _draw_comment_bugs(){var i=0;var feature_limit=7;$(".comment_bug .called_out_sampling").html("");$("#comments li.comment").each(function(){if(i>=feature_limit){return false;}if($(this).hasClass("collapsable")){return true;}var $this=$(this),avatar_src=$this.find('a.avatar img[class!="favicon"]').attr("src"),user_name=$this.find(".entity_block a.user_name").text();var feature_html="";feature_html+='<a class="head" href="#'+$this.attr("id")+'" data-comment-wp-id="'+$this.attr("data-comment-wp-id")+'">';feature_html+='<img height="20" width="20" src="'+avatar_src+'" />';feature_html+='<span class="name">'+user_name+"</span>";if($this.find(".entity_block span.desc").length>0){feature_html+='<span class="desc">'+$this.find(".entity_block span.desc").text()+"</span>";}var excerpt_html="";var comment_content=$this.find(".comment_content p:first-child").text();if(comment_content.length>155){excerpt_html+=comment_content.substring(0,155);excerpt_html+=" [...]";}else{excerpt_html+=comment_content;}feature_html+='<span class="comment">';feature_html+=excerpt_html;feature_html+="</span>";feature_html+="</a>";$(".comment_bug .called_out_sampling").append(feature_html);i++;});$(".comment_bug .called_out_sampling a").unbind("click").bind("click",function(e){var $this=$(this);e.preventDefault();forbes.util.scroll_to_obj($("li.comment[data-comment-wp-id="+$this.attr("data-comment-wp-id")+"]"),{duration:800,valign:true,highlight:true});});$(".comment_bug").show();}function _expand_comment_bug(target_obj){var comment_bug=target_obj.parent().parent().parent();var cur_head=target_obj;comment_bug.find("a.head").each(function(){$(this).css({opacity:0.3});});cur_head.css({opacity:1});comment_bug.find(".bottom_border").width(parseInt(comment_bug.find(".wrapper").width()));var new_html="";new_html+='<img src="'+cur_head.find("img").attr("src")+'" alt="" />';new_html+="<p>";new_html+="<strong>"+cur_head.find("span.name").text()+"</strong>";if(cur_head.find("span.desc").text().length>2){new_html+="<em>"+cur_head.find("span.desc").text()+"</em> ";}new_html+="</p>";new_html+="<p>";new_html+=cur_head.find("span.comment").text();new_html+="</p>";comment_bug.find(".comment_teaser").html(new_html);if(comment_bug.hasClass("show_teaser")&&!comment_bug.hasClass("article_footer")){return false;}comment_bug.addClass("show_teaser");if(!comment_bug.hasClass("article_footer")){comment_bug.find(".comment_teaser").stop().css({opacity:0}).animate({opacity:1},200);}}return{init:_init};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.comments.init);var forbes=(function(app,$){app.comment_form=(function($){var _imagesBaseCdn=null;function _init(){_imagesBaseCdn=$("body").attr("data-images-base-cdn");_init_comment_auth_links();_init_comment_textarea();_init_form();}function _init_form(){forbes.auth.init();if(!forbes.auth.user().logged_in){return false;}$("#comment_reply form .control_bar").show();$("form#idCommentForm").prepend("<input type='hidden' name='_comment_nonce' value='"+$("form#idCommentForm").attr("data-comment-nonce")+"'/>");forbes.forms.init({selector:"form#idCommentForm",on_complete:function(json){forbes.util.debug("comment submitted:");forbes.util.debug(json);if(typeof json.success!="undefined"){_comment_success({comment:json.comment_text_escaped,comment_approved:json.comment_approved,social_share:json.social_share});}return true;}});}function _init_comment_auth_links(){$("#comment_reply a.ajaxify").not(".unireg_logout").unbind("click").bind("click",forbes.auth.handle_auth_links);}function _init_comment_textarea(){var comment_ta=$("textarea.user_comment");comment_ta.unbind("focus").bind("focus",function(){if(!forbes.auth.user().logged_in){forbes.auth.login({reason:{task:"commenting"}});return false;}var $this=$(this);if($this.hasClass("initial_text")&&$this.val()==$this.attr("data-initial-text")){$this.val("");$this.removeClass("initial_text");}});comment_ta.unbind("blur").bind("blur",function(){var $this=$(this);if(!$this.hasClass("initial_text")&&($this.val()==$this.attr("data-initial-text")||$this.val()==""||$this.val()==" ")){$this.addClass("initial_text");$this.val($this.attr("data-initial-text"));}});if(comment_ta.hasClass("initial_text")&&comment_ta.val()!=comment_ta.attr("data-initial-text")){comment_ta.removeClass("initial_text");}}function _comment_success(results){var success_html="";success_html+='<div class="modal_screen comment_success">';success_html+='<div class="main">';success_html+='<p class="large">';success_html+="Thank you for submitting your comment:";success_html+="</p>";if(results.comment_approved){success_html+="<p>";success_html+="New comments typically appear within 30 seconds.";success_html+="</p>";}success_html+="<blockquote>";success_html+="<p>";success_html+=results.comment.replace(/\n\r?/g,"<br />");success_html+="</p>";success_html+="</blockquote>";if(!results.comment_approved){success_html+='<p class="large">';success_html+="<strong>Please note:</strong> Your comment will be reviewed by Forbes staff before appearing on the site.";success_html+="</p>";}if(!!results.social_share){success_html+=results.social_share;}success_html+='<div id="dfp-sociallogo"></div>';success_html+="</div>";success_html+="</div>";forbes.modal_window.load({html:success_html,parse_rules:null,params:null,on_cancel:function(){window.location.reload();},on_complete:function(load_target){_init_ad();}});}function _init_ad(){if(forbes.ad_manager){forbes.ad_manager.display([{id:"sociallogo",sizes:[[120,40]]}]);}else{return false;}}return{init:_init,comment_success:_comment_success};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.comment_form.init);var forbes=(function(app,$){app.contrib_leaderboard=(function($){function _init(){if($("aside .contrib_leaderboard").length<1){return false;}$("aside .contrib_leaderboard form select").change(function(){_load();});_load();}function _load(){$("aside .contrib_leaderboard ul.leaderboard").css({opacity:0.3});$.get($("aside .contrib_leaderboard form").attr("action"),$("aside .contrib_leaderboard form").serialize(),function(data){if($("aside .contrib_leaderboard ul.leaderboard li").length<1){$("aside .contrib_leaderboard .loading_spinner").hide();$("aside .contrib_leaderboard form").show();}$("aside .contrib_leaderboard ul.leaderboard").html(data);$("aside .contrib_leaderboard ul.leaderboard").css({opacity:1});_render();});}function _render(){var contrib_data=new Array();var orig_height=null;$("aside .contrib_leaderboard ul.leaderboard li a").each(function(){var contrib_obj=$.parseJSON($(this).attr("data-contrib-json"));if($(this).find(".graph_bar[origheight]").length<1){$(this).find(".graph_bar").attr("origheight",$(this).find(".graph_bar").height());}orig_height=parseInt($(this).find(".graph_bar").attr("origheight"));$(this).find(".graph_bar").height(orig_height);contrib_obj.orig_height=orig_height;contrib_obj.reference=$(this);contrib_data.push(contrib_obj);});var max_value=contrib_data[0].views;var min_value=contrib_data[contrib_data.length-1].views;var max_value_range=max_value-min_value;var max_graph_bar_height=$("aside .contrib_leaderboard ul.leaderboard li:first-child").height();var graph_bar_range=max_graph_bar_height-orig_height;for(var i=0;i<contrib_data.length;i++){var cur_range=contrib_data[i].views-min_value;var percentage_of_total=cur_range/max_value_range;contrib_data[i].graph_height=Math.round(contrib_data[i].orig_height+(graph_bar_range*percentage_of_total));contrib_data[i].reference.find(".graph_bar").stop().animate({height:contrib_data[i].graph_height},{duration:450,easing:"easeInOutCubic"});contrib_data[i].reference.find(".graph_bar, img").unbind("mouseenter").bind("mouseenter",function(){var json_data=$.parseJSON($(this).parent().attr("data-contrib-json"));$(this).parent().addClass("hovering");$("aside .contrib_leaderboard .contrib_block").show().css({left:($(this).parent().position().left+1)+"px"}).html("<strong>"+json_data.name+"</strong>"+json_data.desc);$("aside .contrib_leaderboard .value_flag").show().css({left:($(this).parent().position().left+1)+"px",top:(($(this).parent().height()-$(this).parent().find(".graph_bar").height())-13)+"px"}).html("+"+forbes.util.number_format(json_data.views)+" views");});contrib_data[i].reference.find(".graph_bar, img").unbind("mouseleave").bind("mouseleave",function(){$("aside .contrib_leaderboard .contrib_block, aside .contrib_leaderboard .value_flag").hide().html("");$("aside .contrib_leaderboard a").removeClass("hovering");});}}return{init:_init};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.contrib_leaderboard.init);var forbes=(function(app,$){app.most_popular=(function($){function _init(){if($("aside .most_popular").length<1){return false;}if($.browser.msie&&parseInt($.browser.version)<8){$("aside .most_popular .toggle_wrapper").css("padding-bottom","1px");}$.get($("aside .most_popular .popular_wrapper").attr("data-url"),{},function(data){if(typeof data=="undefined"||!data||data.length<10){return false;}$("aside .most_popular .popular_wrapper").html(data);$("aside .most_popular .loading_spinner").hide();$("aside .most_popular .toggle_wrapper").show();$("aside .most_popular ul.toggle a").unbind("click").bind("click",function(){if($(this).parent().hasClass("active")){return false;}$("aside .most_popular ul.toggle li").removeClass("active");$(this).parent().addClass("active");_init_type($(this).parent().attr("data-id"));return false;});forbes.interstitial_ad.init_exit_triggers({scope:"aside .most_popular .popular_wrapper"});_init_type($("aside .most_popular ul.toggle li.active").attr("data-id"));});}function _init_type(type){$("aside .most_popular .popular_wrapper ul").hide();var target_ul=$("aside .most_popular .popular_wrapper ul."+type);target_ul.show();target_ul.find("li").each(function(){var parent_ul=$(this).parent(),this_count=parseInt($(this).attr("data-viewcount"),10);$(this).find("span.viewcount").text(parent_ul.attr("data-viewcount-display").replace("[number]",forbes.util.number_format(this_count)));if($(this).parent().hasClass("posts")||$(this).parent().hasClass("contributors")){$(this).find(".graph_bar").css({height:$(this).height()-2});$(this).find(".total_bar").css({height:$(this).height()});}var max_value=parseInt(parent_ul.find("li:first").attr("data-viewcount"));var min_value=parseInt(parent_ul.find("li:last").attr("data-viewcount"));var max_value_range=max_value-min_value;if($(this).find("img").length>0){var min_graph_bar_width=parseInt($(this).find("img").width())+30;}else{var min_graph_bar_width=30;}var graph_bar_range=Math.abs(min_graph_bar_width-(parent_ul.width()-2));var cur_range=this_count-min_value;var percentage_of_total=cur_range/max_value_range;var graph_width=Math.round(min_graph_bar_width+(graph_bar_range*percentage_of_total));$(this).find(".graph_bar").css({width:min_graph_bar_width});$(this).find(".graph_bar").stop().animate({width:graph_width},{duration:600,easing:"easeInOutCubic"});});if(target_ul.find("li").length>5){var middle_item=target_ul.find("li:eq(4)"),init_height=0;if(middle_item.length>0){init_height=middle_item.position().top+middle_item.height();}$("aside .most_popular .popular_wrapper").css({height:init_height,overflow:"hidden"});}else{$("aside .most_popular .show_more_less").hide();var last_item=target_ul.find("li:last"),wrapper_height=0;if(last_item.length>0){wrapper_height=last_item.position().top+last_item.height();}$("aside .most_popular .popular_wrapper").css({height:wrapper_height,overflow:"hidden"});return false;}$("aside .most_popular .show_more_less").show();$("aside .most_popular .show_more_less").removeClass("expanded");$("aside .most_popular .show_more_less span").text("+ show more");$("aside .most_popular .show_more_less").unbind("click").bind("click",function(){if(!$(this).hasClass("expanded")){$(this).omniture_track_click("articleLink_MostPopShowMore");var total_height=$("aside .most_popular").outerHeight()+(target_ul.height()-$("aside .most_popular .popular_wrapper").height());var window_height=$(window).height();if(total_height<window_height){var new_scrolltop=$("aside .most_popular").offset().top-Math.round((window_height-total_height)/2);}else{var new_scrolltop=$("aside .most_popular").offset().top;}$("html,body").animate({scrollTop:new_scrolltop},{duration:500,easing:"easeInOutCubic"});if($.browser.msie&&parseInt($.browser.version)<8){$(this).css("opacity",0);}$("aside .most_popular .popular_wrapper").stop().animate({height:target_ul.height()},{duration:500,easing:"easeInOutCubic",complete:function(){if($.browser.msie&&parseInt($.browser.version)<8){$("aside .most_popular .show_more_less").css("position","absolute").css("position","relative").css("opacity",1);}}});$(this).find("span").text("show less");$(this).addClass("expanded");}else{if($.browser.msie&&parseInt($.browser.version)<8){$(this).css("opacity",0);}$(this).omniture_track_click("articleLink_MostPopShowLess");$("aside .most_popular .popular_wrapper").stop().animate({height:init_height},{duration:500,easing:"easeInOutCubic",complete:function(){if($.browser.msie&&parseInt($.browser.version)<8){$("aside .most_popular .show_more_less").css("position","absolute").css("position","relative").css("opacity",1);}}});$(this).find("span").text("+ show more");$(this).removeClass("expanded");}});}return{init:_init};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.most_popular.init);var forbes=(function(app,$){app.about_modules=(function($){var debug=null,_description_max_height=148;function _init(){debug=forbes.util.debug;_init_meta_icon_rollovers();_init_descriptions();}function _init_meta_icon_rollovers(){if($(".contrib_meta li").length<1){return false;}$(".contrib_meta li").each(function(){$(this).unbind("mouseover").bind("mouseover",function(){var container=$(this).parents(".contrib_meta");container.find(".label").show();container.find(".label .text").text($(this).find("a").text());container.find(".label").css({left:0,width:"auto"});container.find(".label").css({width:(container.find(".label").width()+3)});container.find(".label").css({left:$(this).position().left-(container.find(".label").width()/2)+($(this).width()/2)-10});});$(this).unbind("mouseout").bind("mouseout",function(){$(this).parents(".contrib_meta").find(".label").hide();});});}function _init_descriptions(){if($("aside .about_module .description").length<1){return false;}$("aside .about_module .description").each(function(){if($(this).height()>=_description_max_height){$(this).css({height:_description_max_height+"px",overflow:"hidden"});$(this).find(".show_more_less").show().unbind("click").bind("click",function(){if($(this).parent().find(".show_more_less[origheight]").length<1){$(this).attr("origheight",$(this).height());}if(!$(this).hasClass("expanded")){$(this).omniture_track_click("articleLink_AboutContribShowMore");$(this).addClass("expanded");$(this).find("span").text("show less");$(this).parents(".about_module").find(".description").stop();$(this).animate({height:$(this).find(".shelf").height()+10},{duration:375,easing:"easeInOutCubic"});$(this).parents(".about_module").find(".description").animate({height:$(this).parents(".about_module").find(".description .viewport").height()+($(this).parents(".about_module").find(".description .show_more_less .shelf").height()+10)},{duration:375,easing:"easeInOutCubic"});}else{$(this).omniture_track_click("articleLink_AboutContribShowLess");$(this).removeClass("expanded");$(this).find("span").text("+ show more");$(this).stop().animate({height:parseInt($(this).attr("origheight"))},{duration:375,easing:"easeInOutCubic"});$(this).parents(".about_module").find(".description").stop().animate({height:_description_max_height+"px"},{duration:375,easing:"easeInOutCubic"});}});}});}return{init:_init};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.about_modules.init);var forbes=(function(app,$){app.magazine_subscription=(function($){var _name="",$container,$form;function _init(){$container=$("aside div.block.magazine_bug");$form=$container.find("form.forbes_forms");_init_textboxes();_init_form_validation();$form.find('.fancy_button[data-submit-button="true"]').unbind("click").bind("click",function(){if($form.hasClass("loading")){return false;}$form.trigger("submit");return false;});}function _init_form_validation(){$form.submit(function(e){var cur_form=$(this);cur_form.find("input.initial_text").each(function(){var $this=$(this);if(typeof $this.attr("data-initial-text")=="undefined"){return true;}if($this.val()==$this.attr("data-initial-text")){$this.val("");}});cur_form.addClass("loading");cur_form.find(".fancy_button[data-submit-button=true]").addClass("loading");return true;});}function _init_textboxes(){var textboxes=$container.find("input.textbox");textboxes.bind("focus",function(){var $this=$(this);if($this.hasClass("initial_text")&&$this.val()==$this.attr("data-initial-text")){$this.val("");$this.removeClass("initial_text");}});textboxes.bind("blur",function(){var $this=$(this);if(!$this.hasClass("initial_text")&&($this.val()==$this.attr("data-initial-text")||$this.val()==""||$this.val()==" ")){$this.addClass("initial_text");$this.val($this.attr("data-initial-text"));}});textboxes.each(function(){var $this=$(this);if($this.hasClass("initial_text")&&$this.val()!=$this.attr("data-initial-text")){$this.removeClass("initial_text");}});}return{init:_init};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.magazine_subscription.init);var forbes=(function(app,$){app.sharing_controls=(function($){var debug=forbes.util.debug,_mode="",_initialized=false,_enabled=false,$sticky_sharing=null,$inline_sharing=null,$inline_fallback=null,_parent_selector="#contentwrapper, div.contentwrapper",_container_selector="section#abovefold, section.abovefold",_timeout_embedded_gallery_update=null,_timeout_reveal_controls=null,_delay_reveal_controls=0,_margin_top=100,_margin_bottom=170;function _init(){$sticky_sharing=$("#sticky_sharing");$inline_sharing=$(".inling_sharing");$inline_fallback=$(".inline_sharing_fallback");if($sticky_sharing.length<1){return false;}if($("body").hasClass("header_non_sticky_mode")){_margin_top=20;}if(!_initialized){$sticky_sharing.show();$inline_fallback.hide();$inline_sharing.show();$(window).scroll(function(){_on_scroll();});$(window).resize(function(){_on_window_resize();});_initialized=true;}$("#sticky_sharing, .inline_sharing").stop().css("opacity",0.01);if($("body.galleries").length>0){_delay_reveal_controls=1000;}if(!$.browser.msie){$("#sticky_sharing, .inline_sharing").stop().animate({opacity:1},{duration:400,easing:"easeInOutCubic"});}else{$("#sticky_sharing, .inline_sharing").stop().css({opacity:1});}_enabled=true;_on_scroll();_on_window_resize();}function _controls_are_in_article_body(){if($sticky_sharing.hasClass("in_article_body")){return true;}return false;}function _controls_should_move_to_article_body(){if(!$sticky_sharing.hasClass("in_article_body")&&$(".article .body").length>0){return true;}return false;}function _move_controls_to_article_body(){if($(".article .body .feature_image").length>0){$sticky_sharing.detach().insertAfter(".article .body .feature_image");}else{$sticky_sharing.detach().prependTo(".article .body");}$sticky_sharing=$("#sticky_sharing");$sticky_sharing.addClass("in_article_body");forbes.article_pages.process_embeddables();_on_scroll();}function _move_controls_out_of_article_body(){$sticky_sharing.detach().prependTo(_parent_selector);$sticky_sharing=$("#sticky_sharing");$sticky_sharing.removeClass("in_article_body");forbes.article_pages.process_embeddables();_on_scroll();}function _on_window_resize(){if(forbes.modal_window.is_active()){return false;}if(!_enabled){return false;}_update_widget_position();}function _update_widget_position(){var win_width=$(window).width();var content_width=$(_container_selector).width();content_width+=20*2;if(!$sticky_sharing){return false;}$sticky_sharing.show();_update_galleries();if(((win_width-content_width)/2)<(parseInt($sticky_sharing.css("width"),10)+30)){if($inline_fallback.length>0){$inline_fallback.show();$sticky_sharing.hide();}if(_controls_should_move_to_article_body()){_move_controls_to_article_body();}_update_galleries();return false;}else{var left_margin=(((((win_width-content_width)/2)-$sticky_sharing.width())/2)+8);$sticky_sharing.find(".position_reference").css("margin-left",left_margin+"px");}if($inline_fallback.length>0){$inline_fallback.hide();}if(_controls_are_in_article_body()){_move_controls_out_of_article_body();}_on_scroll();_update_galleries();return false;}function _on_scroll(){if(forbes.modal_window.is_active()){return false;}if(!_enabled){return false;}var $controls=$sticky_sharing.find("div.controls");if($controls.length<1){return false;}var page_scroll=parseInt($(document).scrollTop(),10),fixed_range_top=$sticky_sharing.find(".position_reference").offset().top-_margin_top,fixed_range_bottom=$("footer").offset().top-($controls.outerHeight()+_margin_bottom),in_article_body=(_controls_are_in_article_body())?true:false;if((page_scroll<fixed_range_top&&_mode!="relative")||in_article_body){$controls.css({position:"relative",top:"0"});_mode="relative";}else{if(page_scroll>fixed_range_top&&page_scroll<fixed_range_bottom&&_mode!="fixed"){$controls.css({position:"fixed",top:_margin_top+"px"});_mode="fixed";}else{if(page_scroll>fixed_range_bottom&&_mode!="absolute"){$controls.css({position:"absolute",top:(fixed_range_bottom-$sticky_sharing.find(".position_reference").offset().top+_margin_top)+"px"});_mode="absolute";}}}}function _update_galleries(){if(typeof forbes.galleries!="undefined"&&typeof forbes.galleries.embedded!="undefined"){forbes.galleries.embedded.update();}}function _update(){_update_widget_position();}return{init:_init,update:_update};}($));return app;}(forbes||{},jQuery));var forbes=(function(app,$){app.sticky_ad=(function($){var _mode="",_margin_top=100,_margin_bottom=170,_ad_block=null,$left_rail=null;function _init(){if($("aside .block.ad.sticky").length<1){return false;}if($.browser.msie&&parseInt($.browser.version)<8){return false;}$left_rail=$("div#leftRail");if($left_rail.length<1){$left_rail=$("div.left_rail");}_ad_block=$("aside .sticky_ad_container .block.ad.sticky");_ad_block.parents(".position_reference").css("position","relative");$(window).scroll(function(){_on_scroll();});_on_scroll();}function _reset(){_ad_block.css({position:"relative",top:"0"});_mode="relative";}function _on_scroll(){if(_ad_block.length<1){return false;}var page_scroll=parseInt($(document).scrollTop());var fixed_range_top=$("aside .sticky_ad_container").offset().top-_margin_top;var fixed_range_bottom=$("footer").offset().top-(_ad_block.outerHeight()+_margin_bottom);var left_rail_bottom=$left_rail.offset().top+$left_rail.height()+20;if((page_scroll<fixed_range_top&&_mode!="relative")||((_ad_block.offset().top+_ad_block.height())>left_rail_bottom)){_ad_block.css({position:"relative",top:"0"});_mode="relative";}else{if(page_scroll>fixed_range_top&&page_scroll<fixed_range_bottom&&_mode!="fixed"){_ad_block.css({position:"fixed",top:_margin_top+"px"});_mode="fixed";}else{if(page_scroll>fixed_range_bottom&&_mode!="absolute"){_ad_block.css({position:"absolute",top:(fixed_range_bottom-_ad_block.parents(".position_reference").offset().top+_margin_top)+"px"});_mode="absolute";}}}}return{init:_init,reset:_reset};}($));return app;}(forbes||{},jQuery));forbes.bootstrap.register(forbes.sticky_ad.init);$(document).ready(function(){$.fn.tabular=function(){$(this).find(".tabbed").hide();$(this).find("ul.tabs li:first").addClass("active").show();$(this).find(".tabbed:first").show();$("ul.tabs li").click(function(){$(this).parent().parent().find("ul.tabs li").removeClass("active");$(this).addClass("active");$(this).parent().parent().find(".tabbed").hide();var activeTab=$(this).find("a").attr("rel");$("#"+activeTab).fadeIn();return false;});};$(".tabular").tabular();$("#listwatchtabs ul li.over a img").hover(function(){$(this).stop().fadeTo("slow",0);},function(){$(this).stop().fadeTo("slow",1);});});function initFollowing(){var followingThickBoxJsData=$("#followingThickBoxJsData");var followingEntityType=followingThickBoxJsData.attr("data-entity-type");var followingEntityUri=followingThickBoxJsData.attr("data-entity-uri");var isFollowing=followingThickBoxJsData.attr("data-is-following");var elt=$("div[data-entity-type='"+followingEntityType+"'][data-entity-url='"+followingEntityUri+"']");if(isFollowing){if(elt.find(".buttoncount").attr("class")=="buttoncount follow"){changeFollowing(this,elt);}}$("[name=type]").click(function(){var a=$(this);var signupuri="/following/signup/"+followingEntityType+"/"+followingEntityUri+"/"+$(this).attr("id");$.ajax({url:encodeURI(signupuri),cache:false,success:function(b){$("[name=type]").attr("class","greybuttonlink");a.attr("class","buttonlink");if($(".buttoncount").attr("class")=="buttoncount follow"){changeFollowing(this,elt);}}});return false;});$("#done").click(function(){tb_remove();return false;});addMemberInfo(followingThickBoxJsData);}function addMemberInfo(followingThickBoxJsData){var memberName=followingThickBoxJsData.attr("data-member-name");if(isMember()){if($("#login").size()>0){$("#header_userinfo").html('<b><a href="http://www.forbes.com/membership/editprofile.jhtml">'+memberName+'</a></b>&nbsp;&nbsp;|&nbsp;&nbsp;<a id="myalerts" href="/places/following">Following</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a id="logout" href="http://www.forbes.com/membership/external_logout.jhtml">Logout</a>');}}}function changeFollowing(obj,elt){var followingEntityUri=elt.attr("data-entity-url");var followingEntityType=elt.attr("data-entity-type");var followingEntityName=elt.attr("data-entity-name");var followingButtonEntityName=elt.attr("data-button-entity-name");var count=getCount(this,elt);var elt=$("div[data-entity-type='"+followingEntityType+"'][data-entity-url='"+followingEntityUri+"']");var bchtml='<a href="" class="buttonlink plusmore tooltip" title="'+followingEntityName+'">Following '+followingButtonEntityName+'</a><div class="box-left"></div><span class="count">'+(count+1)+"</span>";elt.find(".buttoncount").html(bchtml);elt.find(".buttoncount").attr("class","buttoncount following");elt.find(".following .tooltip").toggle(function(){return followingClick(this,elt);},function(){$(this).find("#tooltip").remove();});}function followingClick(obj,elt){var manageFollowingUri=elt.attr("data-manage-following-uri");$(obj).append('<span id="tooltip" class="iconoverlay">You follow '+$(obj).attr("title")+'.<ul><li><a id="unfollow" href="">Unfollow</a></li><li><a id="manageLink" href="'+manageFollowingUri+'">Manage who you follow</a></li></ul></span>');$(obj).find("#manageLink").click(function(){location.href=$("#manageLink").attr("href");});$(obj).find("#unfollow").click(function(){return unfollowClick(this,elt);});var b=($(obj).find(".tooltip").width()+16);$(this).find("#tooltip").css("width",b+"px").fadeIn("fast");return false;}function unfollowClick(obj,elt){var followingEntityUri=elt.attr("data-entity-url");var followingEntityType=elt.attr("data-entity-type");var followingEntityName=elt.attr("data-entity-name");var followingButtonEntityName=elt.attr("data-button-entity-name");var unfollowuri="/following/remove/"+followingEntityType+"/"+followingEntityUri;var count=getCount(this,elt);$.ajax({url:encodeURI(unfollowuri),cache:false,success:function(d){var followingHtml='<a href="" class="buttonlink plusmore tooltip tooltipLeft" title="Receive email updates for new stories on '+followingEntityName+'">Follow '+followingButtonEntityName+"</a>";if(count-1!=0){followingHtml+='<div class="box-left"></div><span class="count">'+(count-1)+"</span>";}elt.find(".buttoncount").html(followingHtml);elt.find(".buttoncount").attr("class","buttoncount follow");elt.find(".follow .buttonlink").click(function(){return followClick(obj,elt);});}});return false;}function followClick(obj,elt){var followingEntityUri=elt.attr("data-entity-url");var followingEntityType=elt.attr("data-entity-type");var followingEntityName=elt.attr("data-entity-name");$("#genericFollowing").remove();$("body").append("<div id='genericFollowing' data-value='true'></div>");var signuri="/following/genericView/"+followingEntityType+"/"+followingEntityUri+"?keepThis=true&height=482&width=750";var reguri="/redirect/membership/regbubble/member_req_handler?req_action=following_login&signupRedirectURL="+location.href+"&name="+followingEntityName.replace("&#38;","%26")+"&path="+followingEntityUri+"&category="+followingEntityType+"&keepThis=true&height=482&width=750";if(isMember()){tb_show("",encodeURI(signuri),"");}else{tb_show("",encodeURI(reguri),"");}return false;}function getCount(obj,elt){var count=0;if(elt.find(".count").size()>0){count=parseInt(elt.find(".count").html());}return count;}"use strict";var forbes=(function(app,$){app.share_comment_with=function(share_with,comment_id,blog_id,btn){$.ajax({url:"/wp-admin/admin-ajax.php",dataType:"json",data:{action:"share-comment",share_with:share_with,comment_id:comment_id,blog_id:blog_id},success:function(r){btn.removeClass("clicked").addClass("completed");},error:function(){btn.removeClass("clicked").addClass("error");}});};return app;}(forbes||{},jQuery));jQuery("body").on("click",".forum-share-my-comment .forum-btn",function(e){var is_linked=jQuery(this).hasClass("linked"),share_with=jQuery(this).attr("data-share-with"),comment_id=jQuery(this).parents(".forum-share-my-comment").attr("data-comment-id"),blog_id=jQuery(this).parents(".forum-share-my-comment").attr("data-blog-id"),btn=jQuery(this);if(btn.hasClass("clicked")||btn.hasClass("completed")){return;}btn.addClass("clicked");if(!is_linked){gigya.socialize.addConnection({callback:function(r){console.log("Gigya response");console.log(r);if(r.errorCode==0){forbes.share_comment_with(share_with,comment_id,blog_id,btn);}else{btn.removeClass("clicked").addClass("error");}},provider:share_with});}else{if("facebook"===share_with){if(jQuery(this).hasClass("no-perm")){gigya.socialize.requestPermissions({callback:function(r){console.log("Gigya response");console.log(r);if(r.errorCode==0){forbes.share_comment_with(share_with,comment_id,blog_id,btn);}else{btn.removeClass("clicked").addClass("error");}},permissions:"publish_actions",provider:share_with});}else{forbes.share_comment_with(share_with,comment_id,blog_id,btn);}}else{forbes.share_comment_with(share_with,comment_id,blog_id,btn);}}});__reach_config=forbes.analytics.get_var("forbes.page_meta.simple_reach");(function(){if($.cookie("refURL")!=null){__reach_config.ref_url=$.cookie("refURL");}else{__reach_config.ref_url=document.referrer;}document.cookie="toURL=http://www.forbes.com;path=/; domain=.forbes.com; expires=Thu, 01-Jan-1900 00:00:01 GMT";document.cookie="refURL=http://www.forbes.com;path=/; domain=.forbes.com; expires=Thu, 01-Jan-1900 00:00:01 GMT";var s=document.createElement("script");s.async=true;s.type="text/javascript";s.src=document.location.protocol+"//d8rk54i4mohrb.cloudfront.net/js/reach.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(s);})();